<template>
    <div class="troubleshooting-controls">
        <template v-if="lastStep">
            <button class="btn btn-grey btn-grey-glow">
                Готово
            </button>
            <button class="btn btn-warning btn-warning-glow">
                <span class="btn__icon">
                    <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M24.6627 9.98538L22.4261 9.76982C22.1887 8.81757 21.8056 7.90764 21.2904 7.07219L22.7161 5.35108C22.8561 5.1822 22.8445 4.9347 22.6896 4.77973L20.2703 2.3603C20.1154 2.20533 19.8679 2.19392 19.699 2.33375L17.9766 3.75984C17.1397 3.24845 16.2308 2.86547 15.2802 2.62378L15.0645 0.384013C15.0435 0.166177 14.8603 0 14.6415 0H11.3351C11.1163 0 10.9333 0.166177 10.9123 0.384013L10.6964 2.62378C9.74576 2.86526 8.83687 3.24845 7.99997 3.75984L6.27761 2.33333C6.10895 2.1935 5.86144 2.20491 5.70626 2.35989L3.28704 4.77952C3.13207 4.9347 3.12045 5.1822 3.26049 5.35108L4.68575 7.07198C4.17021 7.90743 3.78682 8.81757 3.54927 9.77003L1.31387 9.98579C1.09645 10.007 0.931099 10.1901 0.932136 10.4086V13.8384C0.930891 14.0566 1.09624 14.24 1.31366 14.2612L3.55176 14.4769C3.79304 15.4273 4.17581 16.3364 4.687 17.1733L3.26028 18.8955C3.11402 19.072 3.13414 19.3328 3.30592 19.4849L5.14093 21.1079C5.23159 21.1881 5.35233 21.2259 5.47287 21.2116C5.59319 21.1971 5.7017 21.1319 5.77099 21.0325L8.40825 17.2484C8.52588 17.0796 8.50555 16.8505 8.35991 16.7049C5.8297 14.1747 5.82949 10.0721 8.35991 7.54168C10.8903 5.01126 14.9929 5.01126 17.5233 7.54168C20.0537 10.0721 20.0537 14.1747 17.5233 16.7049C17.3758 16.8524 17.3571 17.0849 17.4791 17.254L20.2091 21.0379C20.2793 21.1352 20.3873 21.1983 20.5066 21.2116C20.6259 21.2249 20.7452 21.1871 20.835 21.1076L22.6707 19.4853C22.8425 19.3334 22.8628 19.0724 22.7163 18.8957L21.29 17.1733C21.8014 16.3364 22.1844 15.4275 22.4259 14.4769L24.6627 14.2612C24.8801 14.24 25.0455 14.0566 25.0442 13.8384V10.4082C25.0453 10.1899 24.8801 10.0065 24.6627 9.98538ZM24.1945 13.4523L22.0396 13.6602C21.8566 13.6778 21.706 13.8116 21.6668 13.9913C21.4325 15.0537 21.0066 16.0644 20.4102 16.9744C20.3081 17.1304 20.3197 17.3347 20.4386 17.4781L21.7995 19.121L20.6238 20.1604L18.3745 17.0426C20.979 14.1695 20.8956 9.71215 18.1241 6.94066C15.2665 4.08307 10.6167 4.08307 7.7591 6.94066C4.98616 9.7136 4.90421 14.1743 7.51264 17.047L5.34652 20.1552L4.17685 19.1208L5.53759 17.4779C5.65647 17.3341 5.66788 17.13 5.56581 16.974C4.96915 16.0642 4.54302 15.0535 4.30817 13.9913C4.26958 13.8118 4.11938 13.678 3.93681 13.6602L1.7819 13.4523V10.7945L3.93681 10.5864C4.12063 10.5686 4.27166 10.4339 4.31004 10.2532C4.53866 9.19059 4.96458 8.18045 5.56539 7.27467C5.66871 7.11845 5.65751 6.91306 5.53801 6.76888L4.1615 5.1069L6.03364 3.23455L7.69562 4.61085C7.83918 4.72994 8.04353 4.74135 8.19934 4.63907C9.10906 4.04241 10.1198 3.61628 11.182 3.38164C11.3619 3.34181 11.4955 3.19077 11.5131 3.00758L11.721 0.849974H14.2556L14.4637 3.00758C14.4813 3.19077 14.6149 3.34181 14.7946 3.38164C15.857 3.61628 16.8677 4.04261 17.7775 4.63928C17.9333 4.74155 18.1376 4.73014 18.2812 4.61106L19.943 3.23475L21.8151 5.1069L20.4388 6.76888C20.3195 6.91306 20.3085 7.11845 20.4118 7.27446C21.0128 8.18025 21.4388 9.19059 21.6676 10.2532C21.7053 10.4337 21.856 10.5686 22.0394 10.5864L24.1945 10.7943V13.4523Z" fill="black"/>
                    <path d="M14.4699 19.6002V13.1488C15.5408 12.5303 16.2439 11.3563 16.2439 10.1464C16.2439 8.49311 15.2985 7.289 13.715 6.92573C13.583 6.89544 13.4449 6.92967 13.3424 7.01784C13.2401 7.10622 13.1857 7.23796 13.1961 7.37281L13.3366 9.17587C12.9818 9.36196 12.5586 9.36217 12.2036 9.17628L12.3546 7.36327C12.3663 7.22385 12.3086 7.08776 12.2003 6.99917C12.092 6.91059 11.9472 6.88092 11.813 6.91992C10.3647 7.33941 9.4624 8.58501 9.4624 10.1711C9.4624 11.6268 10.2263 12.8044 11.5009 13.3147V19.7413C10.5981 20.2743 9.72816 21.3558 9.74185 22.7319C9.74185 24.3716 10.6767 25.5838 12.2397 25.9749C12.3725 26.0081 12.5129 25.9755 12.6175 25.8874C12.7221 25.7992 12.7779 25.6662 12.7675 25.5299L12.6277 23.7271C12.9822 23.541 13.4056 23.5408 13.7606 23.7264L13.6096 25.5397C13.598 25.6791 13.6556 25.8152 13.7639 25.9037C13.8722 25.9923 14.017 26.022 14.1513 25.983C15.5925 25.5654 16.4966 24.326 16.5111 22.7439C16.5114 21.2879 15.7375 20.1106 14.4699 19.6002ZM14.5154 24.9034L14.6284 23.5447C14.6405 23.4001 14.578 23.2594 14.4627 23.1715L14.4467 23.1592C13.6986 22.5914 12.6621 22.5983 11.9217 23.1758C11.8105 23.2636 11.7503 23.4011 11.7613 23.5424L11.8698 24.9401C11.0518 24.5324 10.5943 23.7536 10.5943 22.7277C10.5833 21.6099 11.3704 20.7288 12.1088 20.3828C12.2575 20.3126 12.3519 20.1624 12.3509 19.9979V13.0137C12.3519 12.8268 12.2302 12.6614 12.0513 12.6069C10.9785 12.283 10.3136 11.3497 10.3136 10.1706C10.3136 9.22109 10.736 8.43605 11.4482 7.99914L11.3356 9.35781C11.3235 9.50262 11.3862 9.64348 11.502 9.73124L11.5177 9.74327C12.2648 10.3109 13.3003 10.3049 14.0405 9.72875C14.0442 9.72585 14.0484 9.72253 14.0519 9.71962C14.1577 9.63145 14.2141 9.49743 14.2035 9.36009L14.0936 7.94748C14.928 8.33855 15.3946 9.11383 15.3946 10.1466C15.3946 11.1092 14.7649 12.0805 13.8633 12.5087C13.7152 12.5791 13.6208 12.7284 13.6208 12.8926V19.901C13.6208 20.0884 13.7436 20.2535 13.9228 20.3077C14.9958 20.6317 15.662 21.5651 15.662 22.7402C15.6529 23.6856 15.227 24.4679 14.5156 24.9034H14.5154Z" fill="black"/>
                    </svg>
                </span>
                <span class="btn__text" @click="callMaster">
                    Вызвать мастера
                </span>
            </button>
        </template>
        <template v-else>
            <template v-if="item.dialog">
                <button class="btn btn-neutral">
                    {{item.dialog[0]}}
                </button>
                <button class="btn btn-grey btn-grey-glow">
                    {{item.dialog[1]}}
                </button>
            </template>
            <template v-else>
                <button class="btn btn-neutral"
                        v-if="instructionStepId > 1"
                        @click="prevStep"
                >
                    Предыдущий шаг
                </button>
                <button class="btn btn-grey btn-grey-glow" @click="nextStep">
                    Следующий шаг
                </button>
            </template>
        </template>
    </div>
</template>

<script>
    import {mapActions} from 'vuex'

    export default {
        name: "TroubleshootingControls",
        props: {
            instructionStepId: Number,
            lastStep: {
                type: Boolean,
                default: false
            },
            item: {
                type: Object,
                default: () => {
                    return {dialog: null}
                }
            }
        },
        methods: {
            ...mapActions({
                popup: 'popup/popup'
            }),
            callMaster () {
                this.popup({icon: 'repair.svg', text: 'Сообщение мастеру успешно отправлено!'})
            },
            nextStep () {
                if (!this.lastStep) {
                    this.$emit('update:instruction-step-id', this.instructionStepId + 1)
                }
            },
            prevStep () {
                this.$emit('update:instruction-step-id', this.instructionStepId - 1)
            }
        },
    }
</script>

<style scoped>
    .troubleshooting-controls {
        display: flex;
        margin-top: 12px;
    }

    .troubleshooting-controls .btn-grey,  .troubleshooting-controls .btn-neutral {
        width: 188px;
        margin-right: 24px;
    }

    .troubleshooting-controls .btn-warning {
        flex: 1;
    }

</style>